# qwq AIOps 平台 - 部署检查清单

## ✅ 部署前检查

### 环境要求
- [ ] Docker 20.10+ 已安装并运行
- [ ] Docker Compose V2 可用
- [ ] 至少 4GB 可用内存
- [ ] 至少 10GB 可用磁盘空间

### 端口检查
- [ ] 8081 端口未被占用（主服务）
- [ ] 3308 端口未被占用（MySQL）
- [ ] 6380 端口未被占用（Redis）
- [ ] 9091 端口未被占用（Prometheus）
- [ ] 3000 端口未被占用（Grafana）

### 配置文件
- [ ] `.env` 文件已创建
- [ ] AI 服务已配置（OpenAI 或 Ollama）
- [ ] `config/prometheus.yml` 存在
- [ ] `config/mysql.cnf` 存在

## 🚀 部署步骤

### 1. 获取代码
```bash
git clone https://github.com/QwQBiG/qwq-aiops.git
cd qwq-aiops
```

### 2. 配置 AI 服务
```bash
cp .env.example .env
nano .env  # 编辑配置
```

### 3. 运行部署
```bash
chmod +x deploy.sh
./deploy.sh
```

## ✅ 部署后验证

### 容器状态
```bash
docker compose ps
```

预期结果：
```
NAME              STATUS
qwq               Up (healthy)
qwq-mysql         Up (healthy)
qwq-redis         Up
qwq-prometheus    Up
qwq-grafana       Up
```

### 健康检查
```bash
curl http://localhost:8081/api/health
```

预期返回：
```json
{"status":"ok"}
```

### 访问测试
- [ ] 前端界面可访问: http://localhost:8081
- [ ] 可以登录系统（admin/admin123）
- [ ] AI 诊断功能正常
- [ ] 监控面板显示数据
- [ ] 容器管理功能正常

## 🔒 安全配置（生产环境）

### 必须修改
- [ ] 修改默认管理员密码
- [ ] 修改 JWT_SECRET
- [ ] 修改 ENCRYPTION_KEY
- [ ] 修改 MySQL 密码

### 推荐配置
- [ ] 启用 HTTPS
- [ ] 配置防火墙
- [ ] 设置自动备份
- [ ] 配置告警通知

## 📊 性能优化

### 资源调整
- [ ] 根据负载调整容器资源限制
- [ ] 配置 MySQL 缓冲池大小
- [ ] 调整 Redis 内存限制

### 监控配置
- [ ] 配置 Prometheus 数据保留时间
- [ ] 设置 Grafana 仪表板
- [ ] 配置告警规则

## 🐛 故障排查

### 如果部署失败

1. **检查日志**
   ```bash
   docker compose logs qwq
   ```

2. **检查构建日志**
   ```bash
   cat build.log
   ```

3. **清理重试**
   ```bash
   docker compose down
   docker system prune -a
   ./deploy.sh
   ```

### 常见问题

| 问题 | 解决方案 |
|------|---------|
| 端口被占用 | 修改 docker-compose.yml 端口映射 |
| AI 不工作 | 检查 .env 中的 AI 配置 |
| 构建超时 | 检查网络连接，使用国内镜像源 |
| 容器无法启动 | 查看日志，检查资源限制 |

## 📝 部署完成

- [ ] 所有容器运行正常
- [ ] 健康检查通过
- [ ] 可以访问前端界面
- [ ] AI 功能测试通过
- [ ] 已修改默认密码
- [ ] 已配置告警通知

**恭喜！qwq AIOps 平台部署成功！** 🎉

---

**下一步**: 
- 阅读[用户手册](docs/user-manual.md)
- 配置[监控告警](docs/monitoring.md)
- 加入[社区讨论](https://github.com/QwQBiG/qwq-aiops/discussions)
